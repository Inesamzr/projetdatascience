---
title: "Formation analyse"
author: "Ines Amzert"
date: "2024-01-01"
output: pdf_document
---

```{r}
library(dplyr)
library(purrr)

# Liste des chemins vers les fichiers CSV
chemins <- c("../Nettoyage_2018/enquete_2018DS-2_nettoyer.csv", "../Nettoyage_2019/2019.csv", "../Nettoyage_2020/enquete_2020DS_nettoyer.csv", "../Nettoyage_2021/enquete_2021DS-2_nettoyer.csv", "../Nettoyage_2022/enquete_2022DS-2_nettoyer.csv", "../Nettoyage2023/enquete_2023DS-2_NR2.csv")

dataframes <- map(chemins, ~ read.csv(.x) %>%
                              mutate(identifiant = as.character(identifiant)) %>%
                              select(identifiant, type_formation, filiere, date_diplome, emploi_formation, satisfaction_formation, alternance, recommandation_polytech, ig_avantage_double_competence, remuneration_annuelle_brute, prime, remuneration_prime))

merged_data <- reduce(dataframes, left_join, by = "identifiant")

write.csv(merged_data, "axeformation.csv", row.names = FALSE)

df <- read.csv("axeformation.csv", header = TRUE, stringsAsFactors = FALSE)
print(df)


```

